<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Feelpp Tutorial Dev</title>
    <link rel="canonical" href="https://feelpp.github.io/feelpp-tutorial-dev/dev/latest/reference/Mesh/README.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

<script src="../../../../_/js/vendor/tabs-block-extension.js"></script>
<script src="../../../../_/js/vendor/tabs-block-behavior.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1],
      p: "{\\mathrm{p}}",
      q:"{\\mathbf{q}}",
      n:"{\\mathbf{n}}",
      T:"{\\mathcal{T}}",
      F:"{\\mathcal{F}}",
      P:"{\\mathcal{P}}",
      v:"{\\mathbf{v}}"
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML'>
</script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->
<script>var uiRootPath = '../../../../_'</script>

  </head>
  <body class="article">
<header class="header">
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark navbar-template-project" style="border-top: 4px solid #9E9E9E">
        <div class="navbar-brand">
            <div class="navbar-item feelpp-logo">
                <a href="https://feelpp.github.io/feelpp-tutorial-dev">Feelpp Tutorial Dev</a>
            </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
                <div class="navbar-item">
                    <a href="https://docs.feelpp.org/">Documentation Reference</a>
                </div>
                <div class="navbar-item">
                    <a class="navbar-brand"  href="https://www.cemosis.fr">
                        <img class="cemosis-logo"  src="../../../../_/img/cemosis-logo.svg" alt="Cemosis logo"/>
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header>
<div class="body">
<div class="nav-container" data-component="dev" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Developer manual</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Programming with Feel++</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Programming environment</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Debugging Feel++</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Profiling Feel++</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#tutorial-dev:ROOT:index.adoc">Feel++ Development Tutorial</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#template_project:ROOT:index.adoc">Feel++ Template Project</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Mathematical Concepts Reference</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="README.html">Mesh</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="iterators.html">Mesh iterators</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Integrals/README.html">Integrals</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/integrate.html">integrate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/mean.html">mean</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/norms.html">norms</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/project.html">project</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Spaces/README.html">Function spaces</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/notations.html">Notations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/functionspace.html">FunctionSpace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/projection.html">Projection</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/interpolation.html">Interpolation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/save.html">Save</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Solver/README.html">Algebraic solutions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/notations.html">Notations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/backend.html">Defining a backend</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/preconditioner.html">Defining a preconditioner</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/solving.html">Solving linear systems</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/eigensolver.html">Solving eigenvalue problems</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../forms.html">Linear and Bilinear Forms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Time/README.html">Time Discretization</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Time/bdf.html">BDF</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Time/adaptivestepping.html">Adaptive time stepping</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../exporter.html">Post-processing and Visualization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Keywords/README.html">Mathematical keywords</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Developer Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../cmake.html">CMake Feel++ macros</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../environment.html">Feel++ Environment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fileformats.html">Feel++ File Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../codingrules.html">Feel++ Coding Rules</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Developer manual</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Developer manual</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../feelpp-project/index.html">Feel++ Project</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../feelpp-project/index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Developer manual</a></li>
    <li><a href="../index.html">Mathematical Concepts Reference</a></li>
    <li><a href="README.html">Mesh</a></li>
  </ul>
</nav>

  
    <div class="edit-this-page"><a href="https://github.com/feelpp/book.feelpp.org/edit/develop/docs/dev/modules/reference/pages/Mesh/README.adoc">Edit this Page</a></div>
  
  <div class="page-downloads">
  <span class="label">Download as</span>
  <ul class="download-options">
    <li>
      <a onclick="print(this)" href="#" data-toggle="tooltip" data-placement="left" title="Print to PDF"
         class="pdf-download">
        <img class="pdf-file-icon icon" src="../../../../_/img/pdf.svg"/> .pdf
      </a>
    </li>
  </ul>
</div>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>

<article class="doc">
<div class="sect1">
<h2 id="_using_computational_meshes"><a class="anchor" href="#_using_computational_meshes"></a>1. Using computational meshes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction"><a class="anchor" href="#_introduction"></a>1.1. Introduction</h3>
<div class="paragraph">
<p>Feel++ provides some tools to manipulate meshes.  Here is a basic
example that shows how to generate a mesh for a square geometry</p>
</div>
<div class="listingblock">
<div class="title">Excerpt from <code>codes/mymesh.cpp</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">    // create a mesh with GMSH using Feel++ geometry tool
    auto mesh = loadMesh(_mesh=new  Mesh&lt;Simplex&lt;2&gt;&gt;);</code></pre>
</div>
</div>
<div class="paragraph">
<p>As always, we initialize the Feel++ environment (see section <a href="#FirstApp">[FirstApp]</a> ).
The <code>unitSquare()</code> will generate a mesh for a square geometry.
Feel++ provides several functions to automate the GMSH mesh generation for different topologies.
These functions will create a geometry file <code>.geo</code> and a mesh file <code>.msh</code>.
We can visualize them in {uri-gmsh-www}[Gmsh].</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gmsh &lt;entity_name&gt;.msh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally we use the <code>exporter()</code> (see \ref Exporter) function to export the mesh for post processing. It will create by default a Paraview format file <code>.sos</code> and an Ensight format file <code>.case</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ paraview &lt;app_name&gt;.case</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this section, we present some of the mesh definition and manipulation tools provided by Feel++.
For more information you can also read {uri-gmsh-manual}[the Gmsh manual].</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_meshes"><a class="anchor" href="#_basic_meshes"></a>1.2. Basic Meshes</h3>
<div class="paragraph">
<p>There is a list of basic geometries you can automatically generate with Feel++ library.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Table of function generation  basic primitive mesh</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feel++ function</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unitSegment()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build a mesh of the unit segment \([0,1\)]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unitSquare()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build a mesh of the unit square \([0,1\)^2] using triangles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unitCircle()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build a mesh of the unit circle using triangles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unitHypercube()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build a mesh of the unit hypercube \([0,1\)^3] using tetrahedrons</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unitSphere()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build a mesh of the unit sphere using tetrahedrons</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh = unitSquare();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_loading_meshes"><a class="anchor" href="#_loading_meshes"></a>1.3. Loading Meshes</h3>
<div class="sect3">
<h4 id="_loadmesh"><a class="anchor" href="#_loadmesh"></a>1.3.1. <code>loadMesh</code></h4>
<div class="paragraph">
<p>You can use this function to load mesh from different formats</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
in the case of a <code>.geo</code> file, Feel++ automatically generate a mesh data structure on this geometrical structure.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_interface"><a class="anchor" href="#_interface"></a>Interface</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">mesh_ptrtype loadMesh(_mesh, _filename, _refine, _update, physical_are_elementary_regions);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Required Parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_mesh</code>  a mesh data structure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optional Parameters:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default Value</th>
<th class="tableblock halign-left valign-top">Option</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_hsize</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">characteristic size of the mesh. This option will edit the <code>.geo</code> file and change the variable <code>h</code> if defined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gmsh.hsize</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_geo_variables_list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set a list of variable that may be defined in a <code>.geo</code> file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">""</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gmsh.geo</code>-variables-list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_filename</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">filename with extension</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>feel.geo</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gmsh.filename</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_depends</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">list of files (separated by , or ;) on which <code>gmsh.filename</code> depends</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">""</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gmsh.depends</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_refine</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optionally refine with \p refine levels the mesh.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0.</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gmsh.refine</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_update</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">update the mesh data structure (build internal faces and edges)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_physical_are_elementary_regions</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">to load specific meshes formats.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false.</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gmsh.physical_are_elementary_regions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_straighten</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">in case of curvilinear elements, straighten the elements which are not touching with a face the boundary of the domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gmsh.straighten</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>_partitioner</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The file you want to load has to be in an appropriate repository.
Feel++ looks for the files in the following directories (in this order):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>current path</p>
</li>
<li>
<p>paths that went through <code>changeRepository()</code>, it means that we look for example into the path from which the executable was run</p>
</li>
<li>
<p><code>localGeoRepository()</code> which is usually "$HOME/feel/geo"  (<a href="#environment.adoc">Environment</a> )</p>
</li>
<li>
<p><code>systemGeoRepository()</code> which is usually "$FEELPP_DIR/share/feel/geo" (<a href="#environment.adoc">Environment</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_examples"><a class="anchor" href="#_examples"></a>Examples</h5>
<div class="paragraph">
<p>Load a mesh data structure from the file <code>$HOME/feel/mymesh.msh</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh = loadMesh(_mesh=new mesh_type,
                     _filename="mymesh.msh");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Load a geometric structure from the file <code>./mygeo.geo</code> and automatically create a mesh data structure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh = loadMesh(_mesh=new mesh_type,
                     _filename="mygeo.geo");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a mesh data structure from the file <code>./feel.geo</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh = loadMesh(_mesh=new Mesh&lt;Simplex&lt; 2 &gt; &gt; );</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_loadgmshmesh"><a class="anchor" href="#_loadgmshmesh"></a>1.3.2. loadGMSHMesh</h4>
<div class="paragraph">
<p>In order to load only <code>.msh</code> file, you can also use the loadGMSHMesh.</p>
</div>
<div class="paragraph">
<p><strong>Interface:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">mesh_ptrtype loadGMSHMesh(_mesh, _filename, _refine, _update, _physical_are_elementary_regions);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Required Parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_mesh</code>  a mesh data structure.</p>
</li>
<li>
<p><code>_filename</code>  filename with extension.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optional Parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_refine</code>  optionally refine with \p refine levels the mesh.       - Default =<code>0</code></p>
</li>
<li>
<p><code>_update</code>  update the mesh data structure (build internal faces and edges).</p>
<div class="ulist">
<ul>
<li>
<p>Default =<code>true</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_physical_are_elementary_regions</code>  to load specific meshes formats.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>false</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The file you want to load has to be in an appropriate repository. See <a href="Tutorial/03-LoadingMesh.adoc">LoadMesh</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_examples_2"><a class="anchor" href="#_examples_2"></a>1.3.3. Examples</h4>
<div class="paragraph">
<p>From <code>doc/manual/heatns.cpp</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp"> mesh_ptrtype mesh = loadGMSHMesh( _mesh=new mesh_type,
                                   _filename="piece.msh",
                                   _update=MESH_CHECK|MESH_UPDATE_FACES|MESH_UPDATE_EDGES|MESH_RENUMBER );</code></pre>
</div>
</div>
<div class="paragraph">
<p>From <code>applications/check/check.cpp</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">mesh = loadGMSHMesh( _mesh=new mesh_type,
                     _filename=soption("filename"),
                     _rebuild_partitions=(Environment::worldComm().size() &gt; 1),
                     _update=MESH_RENUMBER|MESH_UPDATE_EDGES|MESH_UPDATE_FACES|MESH_CHECK );</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_meshes"><a class="anchor" href="#_creating_meshes"></a>1.4. Creating Meshes</h3>
<div class="sect3">
<h4 id="_creategmshmesh"><a class="anchor" href="#_creategmshmesh"></a>1.4.1. createGMSHMesh</h4>
<div class="sect4">
<h5 id="_interface_2"><a class="anchor" href="#_interface_2"></a>Interface</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">mesh_ptrtype createGMSHMesh(_mesh, _desc, _h, _order, _parametricnodes, _refine, _update, _force_rebuild, _physical_are_elementary_regions);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Required Parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_mesh</code>  mesh data structure.</p>
</li>
<li>
<p><code>_desc</code>  descprition. See further.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optional Parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_h</code>  characteristic size.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>0.1</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_order</code>  order.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>1</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_parametricnodes</code></p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>0</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_refine</code>  optionally refine with \p refine levels the mesh.</p>
<div class="ulist">
<ul>
<li>
<p>Default =<code>0</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_update</code>  update the mesh data structure (build internal faces and edges).</p>
<div class="ulist">
<ul>
<li>
<p>Default =<code>true</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_force_rebuild</code>  rebuild mesh if already exists.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>false</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_physical_are_elementary_regions</code>  to load specific meshes formats.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>false</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To generate your mesh you need a description parameter. This one can be create by one the two following function.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_geo"><a class="anchor" href="#_geo"></a>1.4.2. geo</h4>
<div class="paragraph">
<p>Use this function to create a description from a <code>.geo</code> file.</p>
</div>
<div class="sect4">
<h5 id="_interface_3"><a class="anchor" href="#_interface_3"></a>Interface</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">gmsh_ptrtype geo(_filename, _h, _dim, _order, _files_path);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Required Parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>filename</code>: file to load.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optional Parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_h</code>  characteristic size of the mesh.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>0.1.</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_dim</code>  dimension.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>3.</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_order</code>  order.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>1.</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_files_path</code>  path to the file.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>localGeoRepository().</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The file you want to load has to be in an appropriate repository. See <a href="Tutorial/03-LoadingMesh.adoc">LoadMesh</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_example"><a class="anchor" href="#_example"></a>Example</h5>
<div class="paragraph">
<p>From <code>doc/manual/heat/ground.cpp</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">mesh = createGMSHMesh( _mesh=new mesh_type,
                       _desc=geo( _filename="ground.geo",
                                  _dim=2,
                                  _order=1,
                                  _h=meshSize ) );</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Excerpt from <code>doc/manual/fd/penalisation.cpp</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">mesh = createGMSHMesh( _mesh=new mesh_type,
                       _desc=geo( _filename=File_Mesh,
                                  _dim=Dim,
                                  _h=doption(_name="gmsh.hsize"),
                                  _update=MESH_CHECK|MESH_UPDATE_FACES|MESH_UPDATE_EDGES|MESH_RENUMBER );</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_domain"><a class="anchor" href="#_domain"></a>1.4.3. domain</h4>
<div class="paragraph">
<p>Use this function to generate a simple geometrical domain from parameters.</p>
</div>
<div class="sect4">
<h5 id="_interface_4"><a class="anchor" href="#_interface_4"></a>Interface</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">gmsh_ptrtype domain(_name, _shape, _h, _dim, _order, _convex, \
                    _addmidpoint, _xmin, _xmax, _ymin, _ymax, _zmin, _zmax);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Required Parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_name</code>  name of the file that will ge generated without extension.</p>
</li>
<li>
<p><code>_shape</code>  shape of the domain to be generated (simplex or hypercube).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optional Parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_h</code>  characteristic size of the mesh.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>0.1</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_dim</code>  dimension of the domain.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>2</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_order</code>  order of the geometry.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>1</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_convex</code>  type of convex used to mesh the domain.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>simplex</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_addmidpoint</code>  add middle point.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>true</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_xmin</code>  minimum x coordinate.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>0</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_xmax</code>  maximum x coordinate.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>1</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_ymin</code>  minimum y coordinate.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>0</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_ymax</code>  maximum y coordinate.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>1.</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_zmin</code>  minimum z coordinate.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>0</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>_zmax</code>  maximum z coordinate.</p>
<div class="ulist">
<ul>
<li>
<p>Default = <code>1</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_example_2"><a class="anchor" href="#_example_2"></a>Example</h5>
<div class="paragraph">
<p>From <code>doc/manual/laplacian/laplacian.ccp</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">mesh_ptrtype mesh = createGMSHMesh( _mesh=new mesh_type,
                                    _desc=domain( _name=( boost::format( "%1%-%2%" ) % shape % Dim ).str() ,
                                                  _usenames=true,
                                                  _shape=shape,
                                                  _h=meshSize,
                                                  _xmin=-1,
                                                  _ymin=-1 ) );</code></pre>
</div>
</div>
<div class="paragraph">
<p>From <code>doc/manual/stokes/stokes.cpp</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">mesh = createGMSHMesh( _mesh=new mesh_type,
                       _desc=domain( _name=(boost::format("%1%-%2%-%3%")%"hypercube"%convex_type().dimension()%1).str() ,
                                     _shape="hypercube",
                                     _dim=convex_type().dimension(),
                                     _h=meshSize ) );</code></pre>
</div>
</div>
<div class="paragraph">
<p>From <code>doc/manual/solid/beam.cpp</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">mesh_ptrtype mesh = createGMSHMesh( _mesh=new mesh_type,
                                    _update=MESH_UPDATE_EDGES|MESH_UPDATE_FACES|MESH_CHECK,
                                    _desc=domain( _name=( boost::format( "beam-%1%" ) % nDim ).str(),
                                                  _shape="hypercube",
                                                  _xmin=0., _xmax=0.351,
                                                  _ymin=0., _ymax=0.02,
                                                  _zmin=0., _zmax=0.02,
                                                  _h=meshSize ) );</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mesh_iterators"><a class="anchor" href="#_mesh_iterators"></a>1.5. Mesh iterators</h3>
<div class="paragraph">
<p>Feel++ mesh data structure allows to iterate over its entities:
elements, faces, edges and points.</p>
</div>
<div class="paragraph">
<p>The following table describes free-functions that allow to define mesh
region over which to operate. MeshType denote the type of mesh passed
to the free functions in the table.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
MeshType can be a pointer, a shared_pointer or a reference to a mesh type.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh = loadMesh( _mesh=Mesh&lt;Simplex&lt;2&gt;&gt;);
auto r1 = elements(mesh); // OK
auto r2 = elements(*mesh); // OK</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Table of mesh iterators</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>elements_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>elements(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the elements of a mesh</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markedelements_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markedelements(mesh, id)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the elements marked by marked id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boundaryelements_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boundaryelements(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the elements of the mesh which share a face with the boundary of the mesh.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>internalelements_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>internalelements(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the elements of the mesh which share a face with the boundary of the mesh.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pid_faces_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>faces(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the faces of the mesh.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markedfaces_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markedfaces(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the faces of the mesh which are marked.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boundaryfaces_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boundaryfaces(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All elements that own a topological dimension one below the mesh. For example, if you mesh is a 2D one, <code>boundaryfaces(mesh)</code>  will return all the lines (because of dimension \(2-1=1\)). These elements which have one dimension less, are corresponding to the boundary faces.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>internalfaces_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>internalfaces(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All internal faces of the mesh (not on the boundary).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>edges_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>edges(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the edges of the mesh.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boundaryedges_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boundaryedges(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All boundary edges of the mesh.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>points_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>points(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the points of the mesh.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markedpoints_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markedpoints(mesh,id)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All the points marked id of  mesh.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boundarypoints_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boundarypoints(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All boundary points of the mesh.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>internalpoints_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>internalpoints(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All internal points of the mesh(not on the boundary)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Here are some examples on how to use these functionSpace</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh = ...;

auto r1 = elements(mesh);
// iterate over the set of elements local to the process(no ghost cell selected, see next section)
for ( auto const&amp;  e : r2 )
{
  auto const&amp; elt = unwrap_ref( e );
  // work with element elt
  ...
}

auto r2 = markedelements(mesh,"iron");
// iterate over the set of elements marked iron in the mesh
for ( auto const&amp;  e : r2 )
{
  auto const&amp; elt = unwrap_ref( e );
  // work with element elt
  ...
}

auto r3 = boundaryfaces(mesh);
// iterate over the set of faces on the boundary of the mesh
for ( auto const&amp;  e : r3 )
{
  auto const&amp; elt = unwrap_ref( e );
  // work with element elt
  ...
}

auto r4 = markededges(mesh,"line");
// iterate over the set of edges marked "line" in the mesh
for ( auto const&amp;  e : r4 )
{
  auto const&amp; elt = unwrap_ref( e );
  // work with element elt
  ...
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_extended_set_of_entities"><a class="anchor" href="#_extended_set_of_entities"></a>1.5.1. Extended set of entities</h4>
<div class="paragraph">
<p>Feel++ allows also to select an extended sets of entities from the mesh, you can extract entities which belongs to the local process but also ghost entities which satisfy the same property as the local ones.</p>
</div>
<div class="paragraph">
<p>Actually you can select both or one one of them thanks to the enum data structure entity_process_t which provides the following options</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entity_process_t</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOCAL_ONLY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">only local entities</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GHOST_ONLY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">only ghost entities</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ALL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">both local and ghost entities</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Function</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ext_elements_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>elements(mesh,entity_process_t)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all the elements of mesh associated to entity_process_t.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ext_elements_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markedelements(mesh, id, entity_process_t)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all the elements marked id of mesh associated to entity_process_t.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ext_faces_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>faces(mesh,entity_process_t)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all the faces of mesh associated to entity_process_t.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ext_faces_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markedfaces(mesh, id, entity_process_t)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all the faces marked id of mesh associated to entity_process_t.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ext_edges_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>edges(mesh,entity_process_t)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all the edges of mesh associated to entity_process_t.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ext_edges_t&lt;MeshType&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markededges(mesh, id, entity_process_t)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all the edges marked id of mesh associated to entity_process_t.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The type of the object returned for an entity is always the same, for elements it is <code>ext_elements_t&lt;MeshType&gt;</code> whether the elements are marked or not.
The reason is that in fact we have to create a temporary data structure embedded in the range object that stores a reference to the elements which are selected.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is how to select both local and ghost elements from a Mesh</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh =...;
auto r = elements(mesh,entity_process_t::ALL);
for (auto const&amp; e : r )
{
  // do something on the local and ghost element
  ...
  // do something special on ghost cells
  if ( unwrap_ref(e).isGhostCell() )
  {...}
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_concatenate_sets_of_entities"><a class="anchor" href="#_concatenate_sets_of_entities"></a>1.5.2. Concatenate sets of entities</h4>
<div class="paragraph">
<p>Denote \(\mathcal{E}_{1}, \ldots ,\mathcal{E}_{n}\) \(n\) <strong>disjoints</strong> sets of the same type of entities (eg elements, faces,edges or points), \(\cup_{i=1}^{n} \mathcal{E}_i\) with \(\cap_{i=0}^{n} \mathcal{E}_i = \emptyset\).</p>
</div>
<div class="paragraph">
<p>We wish to concatenate these \(n\) sets. To this end, we use <code>concatenate</code> which takes an arbitrary number of <strong>disjoints</strong> sets.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">#include &lt;feel/feelmesh/concatenate.hpp&gt;
...
auto E_1 = internalfaces(mesh);
auto E_2 = markedfaces(mesh,"Gamma_1");
auto E_3 = markedfaces(mesh,"Gamma_2");
auto newset = concatenate( E_1, E_2, E_3 );
cout &lt;&lt; "measure of newset = " &lt;&lt; integrate(_range=newset, _expr=cst(1.)).evaluate() &lt;&lt; std::endl;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compute_the_complement_of_a_set_of_entities"><a class="anchor" href="#_compute_the_complement_of_a_set_of_entities"></a>1.5.3. Compute the complement of a set of entities</h4>
<div class="paragraph">
<p>Denote \(\mathcal{E}\) a set of entities, eg. the set of all faces
(both internal and boundary faces). Denote \(\mathcal{E}_\Gamma\) a
set of entities marked by \(\Gamma\). We wish to build
\({\Gamma}^c=\mathcal{E}\backslash\Gamma\). To compute the complement,
Feel++ provides a <code>complement</code> template function that requires
\(\mathcal{E}\) and a predicate that return <code>true</code> if an entity of
\(\mathcal{E}\) belongs to \(\Gamma\), <code>false</code> otherwise. The function
returns mesh iterators over \(\Gamma^c\).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">#include &lt;feel/feelmesh/complement.hpp&gt;
...
auto E = faces(mesh);
// build set of boundary faces, equivalent to boundaryfaces(mesh)
auto bdyfaces = complement(E,[](auto const&amp; e){return e.isOnBoundary()});
cout &lt;&lt; "measure of bdyfaces = " &lt;&lt; integrate(_range=bdyfaces, _expr=cst(1.)).evaluate() &lt;&lt; std::endl;
// should be the same as above
cout &lt;&lt; "measure of boundaryfaces = " &lt;&lt; integrate(_range=boundaryfaces(mesh), _expr=cst(1.)).evaluate() &lt;&lt; std::endl;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_helper_function_on_entities_set"><a class="anchor" href="#_helper_function_on_entities_set"></a>1.5.4. Helper function on entities set</h4>
<div class="paragraph">
<p>Feel++ provides some helper functions to apply on set of entities. We
denote by range_t the type of the entities set.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Utility functions</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Function</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">size_type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nelements(range_t,bool)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns the local number of elements in entities set range_t of bool is false, other the global number which requires communication (default: global number)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WorldComm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">worldComm(range_t)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">returns the WorldComm associated to the entities set</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_create_a_new_range"><a class="anchor" href="#_create_a_new_range"></a>1.5.5. Create a new range</h4>
<div class="paragraph">
<p>A range can be also build directly by the user. This customized range
is stored in a std container which contains the c&#43;+ references of
entity object. We use boost::reference_wrapper for take c++ references
and avoid copy of mesh data. All entities enumerated in the range must
have same type (elements,faces,edges,points). Below we have an example
which select all active elements in mesh for the current partition
(i.e. identical to elements(mesh)).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh = ...;
// define reference entity type
typedef boost::reference_wrapper&lt;typename mesh_type::element_type const&gt; element_ref_type;
// store entities in a vector
typedef std::vector&lt;element_ref_type&gt; cont_range_type;
boost::shared_ptr&lt;cont_range_type&gt; myelts( new cont_range_type );
for (auto const&amp; elt : elements(mesh) )
{
    myelts-&gt;push_back(boost::cref(elt));
}
// generate a range object usable in feel++
auto myrange = boost::make_tuple( mpl::size_t&lt;MESH_ELEMENTS&gt;(),
                                  myelts-&gt;begin(),myelts-&gt;end(),myelts );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, this range can be used in feel++ language.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">double eval = integrate(_range=myrange,_expr=cst(1.)).evaluate()(0,0);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mesh_markers"><a class="anchor" href="#_mesh_markers"></a>1.6. Mesh Markers</h3>
<div class="paragraph">
<p>Elements and their associated sub-entities can be marked.</p>
</div>
<div class="paragraph">
<p>A <em>marker</em> is an integer specifying for example a material id, a boundary condition id or some other property associated with the entity.</p>
</div>
<div class="paragraph">
<p>A dictionary can map string to marker ids.</p>
</div>
<div class="paragraph">
<p>The dictionary is stored in the Mesh data structures and provides the set of correspondances between strings and ids.</p>
</div>
<div class="paragraph">
<p>To access a marker, it is necessary to verify that it exists as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">for( auto const&amp; ewrap : elements(mesh))
{
  auto const&amp; e = unwrap_ref( ewrap );
  if ( e.hasMarker() ) <i class="conum" data-value="1"></i><b>(1)</b>
  {
    std::cout &lt;&lt; "Element " &lt;&lt; e.id() &lt;&lt; " has marker " &lt;&lt; e.marker() &lt;&lt; std::endl;
  }
  if ( e.hasMarker(5) ) <i class="conum" data-value="2"></i><b>(2)</b>
  {
    std::cout &lt;&lt; "Element " &lt;&lt; e.id() &lt;&lt; " has marker 5 " &lt;&lt; e.marker(5) &lt;&lt; std::endl;
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>check if marker 1 (the default marker) exists, if yes then print it</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>check if marker 5 exists, if yes then print it</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_concatenate_range_of_iterators"><a class="anchor" href="#_concatenate_range_of_iterators"></a>1.7. Concatenate range of iterators</h3>
<div class="paragraph">
<p>The  <code>concatenate</code> function takes a set of iterators over geometrical entities of the same
type (e.g. faces, volumes, edges, points).
It generates a data structure that will hold the corresponding reference of mesh elements.
This data structure can then be used to iterate over meshes like other mesh filters.</p>
</div>
<div class="listingblock">
<div class="title">example of faces union : internal and marked</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">// the following code below merges internal faces with inlet faces
auto subset = concatenate( internalfaces(mesh), markedfaces(mesh,"inlet") );
// it can then be used eg to create a submesh
auto submesh = createSubmesh( mesh, subset );</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">example of elements union touching the boundary with a point, edge or face</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto rangeFaces = boundaryfaces(mesh);
// elts connected by a point
auto range1 = elements(mesh,rangeFaces,ElementsType::MESH_POINTS);
// elts connected by a edge (in 2d correspont to face case)
auto range2= elements(mesh,rangeFaces,ElementsType::MESH_EDGES );
// elts connected by a face
auto range3 = elements(mesh,rangeFaces,ElementsType::MESH_FACES );
auto allelt_touching_the_boundary = concatenate(range1,range2,range3);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mesh_operations"><a class="anchor" href="#_mesh_operations"></a>1.8. Mesh Operations</h3>
<div class="sect3">
<h4 id="_straightenmesh"><a class="anchor" href="#_straightenmesh"></a>1.8.1. <code>straightenMesh</code></h4>
<div class="paragraph">
<p>One of the optimisations that allows to have a huge gain in computational effort is to straighten all the high order elements except for the boundary faces of the computational mesh.
This is achieved by moving all the nodes associated to the high order transformation to the position these nodes would have if a first order geometrical transformation were applied.
This procedure can be formalized in the following operator</p>
</div>
<div id="mesh:straighten" class="stemblock">
<div class="content">
\[\mathbf{\eta}^{\mathrm{straightening}}_K(\mathbf{\varphi}^N_{K}(\mathbf{x}^*)) = \left(\mathbf{\varphi}^1_{K}(\mathbf{x}^*)-\mathbf{\varphi}^N_{K}(\mathbf{x}^*)\right) - {\left( \mathbf{\varphi}^1_{K \cap \Gamma}(\mathbf{x}^*)-\mathbf{\varphi}^N_{K \cap \Gamma}(\mathbf{x}^*)\right)}\]
</div>
</div>
<div class="paragraph">
<p>where \(\mathbf{x}^*\) is any point in \(K^*\) and \(\mathbf{\varphi}^1_{K}(\mathbf{x}^*)\) and \(\mathbf{\varphi}^N_{K}(\mathbf{x}^*)\) its images by the geometrical transformation of order one and order \(N\), respectively.
On one hand, the first two terms ensure that for all \(K\) not intersecting \(\Gamma\), the order one and \(N\) transformations produce the same image.
On the other hand, the last two terms are 0 unless the image of \(\mathbf{x}^*\) in on \(\Gamma\) and, in this case, we don’t move the high order image of \(\mathbf{x}^*\).
This allows to have straight internal elements and elements touching the boundary to remain high order.
When applying numerical integration, specific quadratures are considered when dealing with internal elements or elements sharing a face with the boundary.
The performances, thanks to this transformation, are similar to the ones obtained with first order meshes.
However, it needs to be used with care as it can generate folded meshes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_createsubmesh"><a class="anchor" href="#_createsubmesh"></a>1.8.2. <code>createSubmesh</code></h4>
<div class="paragraph">
<p>In multiphysics applications or using advanced numerical methods <em>e.g.</em> involving Lagrange multipliers, it is often required to define <a href="#Spaces/README.adoc">Function Spaces</a> on different meshes.
Theses meshes are often related.
Consider for example a heat transfer problem on a domain \(\Omega\) coupled with fluid flow problem on a domain \(\Omega_f \subset \Omega\) as in the {uri-benchmarks}heat[Heat Transfer benchmarks].
<code>createSubmesh</code> allows to extract \(\Omega_f\) out of \(\Omega\) while keeping information on the relation between the two meshes to be able to transfer data between these meshes very efficiently.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto mesh=loadMesh(_mesh=new Mesh&lt;Simplex&lt;d&gt;&gt;); <i class="conum" data-value="1"></i><b>(1)</b>
auto fluid_mesh = createSubmesh( mesh, markedelements(mesh,"Air") ); <i class="conum" data-value="2"></i><b>(2)</b>
auto face_mesh = createSubmesh( mesh, faces(mesh) ); <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>create a mesh of simplices of dimension \(d\)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>extract  a mesh subregion \(\Omega_f\) marked Air from a mesh \(\Omega\)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>extract a \(d-1\) mesh made of all the faces of the \(d\) mesh</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer" style="border-top: 2px solid #e9e9e9; background-color: #fafafa; padding-bottom: 2em; padding-top: 2em;">
    <div class="container" style="display: flex; flex-direction: column; align-items: center; gap: 0.5em;">
        <div>
            <a href="https://www.cemosis.fr">
                <img src="../../../../_/img/cemosis-logo.svg" alt="Cemosis logo" height="50">
            </a>
        </div>
        <span style="font-size: 0.8rem; color: #9e9e9e">© 2023 <a href="https://www.cemosis.fr" style="text-decoration: underline;">Cemosis</a>, Université de Strasbourg</span>
    </div>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>


<script async src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>


<script type="text/javascript">
function toggleFullScreen() {
   var doc = window.document;
   var docEl = doc.documentElement;

   var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
   var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

   if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
       requestFullScreen.call(docEl);
   }
   else {
       cancelFullScreen.call(doc);
   }
}
</script>
  </body>
</html>
