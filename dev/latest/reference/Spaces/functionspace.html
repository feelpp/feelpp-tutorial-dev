<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Function Spaces :: Feelpp Tutorial Dev</title>
    <link rel="canonical" href="https://feelpp.github.io/feelpp-tutorial-dev/dev/latest/reference/Spaces/functionspace.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

<script src="../../../../_/js/vendor/tabs-block-extension.js"></script>
<script src="../../../../_/js/vendor/tabs-block-behavior.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1],
      p: "{\\mathrm{p}}",
      q:"{\\mathbf{q}}",
      n:"{\\mathbf{n}}",
      T:"{\\mathcal{T}}",
      F:"{\\mathcal{F}}",
      P:"{\\mathcal{P}}",
      v:"{\\mathbf{v}}"
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML'>
</script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->
<script>var uiRootPath = '../../../../_'</script>

  </head>
  <body class="article">
<header class="header">
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark navbar-template-project" style="border-top: 4px solid #9E9E9E">
        <div class="navbar-brand">
            <div class="navbar-item feelpp-logo">
                <a href="https://feelpp.github.io/feelpp-tutorial-dev">Feelpp Tutorial Dev</a>
            </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
                <div class="navbar-item">
                    <a href="https://docs.feelpp.org/">Documentation Reference</a>
                </div>
                <div class="navbar-item">
                    <a class="navbar-brand"  href="https://www.cemosis.fr">
                        <img class="cemosis-logo"  src="../../../../_/img/cemosis-logo.svg" alt="Cemosis logo"/>
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header>
<div class="body">
<div class="nav-container" data-component="dev" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Developer manual</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Programming with Feel++</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Programming environment</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Debugging Feel++</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Profiling Feel++</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../../tutorial-dev/index.html">Feel++ Development Tutorial</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#template_project:ROOT:index.adoc">Feel++ Template Project</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Mathematical Concepts Reference</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Mesh/README.html">Mesh</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Mesh/iterators.html">Mesh iterators</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Integrals/README.html">Integrals</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/integrate.html">integrate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/mean.html">mean</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/norms.html">norms</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/project.html">project</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="README.html">Function spaces</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="notations.html">Notations</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="functionspace.html">FunctionSpace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="projection.html">Projection</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="interpolation.html">Interpolation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="save.html">Save</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Solver/README.html">Algebraic solutions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/notations.html">Notations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/backend.html">Defining a backend</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/preconditioner.html">Defining a preconditioner</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/solving.html">Solving linear systems</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/eigensolver.html">Solving eigenvalue problems</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../forms.html">Linear and Bilinear Forms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Time/README.html">Time Discretization</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Time/bdf.html">BDF</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Time/adaptivestepping.html">Adaptive time stepping</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../exporter.html">Post-processing and Visualization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Keywords/README.html">Mathematical keywords</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Developer Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../cmake.html">CMake Feel++ macros</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../environment.html">Feel++ Environment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fileformats.html">Feel++ File Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../codingrules.html">Feel++ Coding Rules</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Developer manual</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Developer manual</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../tutorial-dev/index.html">Feel++ Tutorial Dev</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../tutorial-dev/index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Developer manual</a></li>
    <li><a href="../index.html">Mathematical Concepts Reference</a></li>
    <li><a href="README.html">Function spaces</a></li>
    <li><a href="functionspace.html">FunctionSpace</a></li>
  </ul>
</nav>

  
    <div class="edit-this-page"><a href="https://github.com/feelpp/book.feelpp.org/edit/develop/docs/dev/modules/reference/pages/Spaces/functionspace.adoc">Edit this Page</a></div>
  
  <div class="page-downloads">
  <span class="label">Download as</span>
  <ul class="download-options">
    <li>
      <a onclick="print(this)" href="#" data-toggle="tooltip" data-placement="left" title="Print to PDF"
         class="pdf-download">
        <img class="pdf-file-icon icon" src="../../../../_/img/pdf.svg"/> .pdf
      </a>
    </li>
  </ul>
</div>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>

<article class="doc">
<h1 class="page">Function Spaces</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Function spaces support is provided by the <code>FunctionSpace</code> class</p>
</div>
<div class="paragraph">
<p>The <code>FunctionSpace</code> class</p>
</div>
<div class="ulist">
<ul>
<li>
<p>constructs the table of degrees of freedom which maps local (elementwise) degrees of freedom to the global ones with respect to the geometrical entities,</p>
</li>
<li>
<p>embeds the definition of the elements of the function space allowing for a tight coupling between the elements and their function spaces,</p>
</li>
<li>
<p>stores an interpolation data structure (e.g. region tree) for rapid localisation of point sets (determining in which element they reside).</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C++ Function</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C++ Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Function Space <a href="#1">[1]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pch&lt;N&gt;(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pch_type&lt;MeshType,N&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(P^N_{c,h}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pchv&lt;N&gt;(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pchv_type&lt;MeshType,N&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\([P^N_{c,h}\)^d]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pdh&lt;N&gt;(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pdh_type&lt;MeshType,N&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(P^N_{d,h}\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pdhv&lt;N&gt;(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pdhv_type&lt;MeshType,N&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\([P^N_{d,h}\)^d]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>THch&lt;N&gt;(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>THch_type&lt;MeshType,N&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\([P^{N+1}_{c,h}\)^d \times P^N_{c,h}]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Dh&lt;N&gt;(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Dh_type&lt;MeshType,N&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mathbb{R}\mathbb{T}_h\)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Ned1h&lt;N&gt;(mesh)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Ned1h_type&lt;MeshType,N&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">\(\mathbb{N}_h\)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>[[[1]]]: see <a href="notations.adoc">Notations</a> for the function spaces definitions.</p>
</div>
<div class="paragraph">
<p>Here are some examples how to define function spaces with Lagrange basis functions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">#include &lt;feel/feeldiscr/pch.hpp&gt;

// Mesh with triangles
using MeshType = Mesh&lt;Simplex&lt;2&gt;&gt;;
// Space spanned by P3 Lagrange finite element
FunctionSpace&lt;MeshType,bases&lt;Lagrange&lt;3&gt;&gt;&gt; Xh;
// is equivalent to (they are the same type)
Pch_type&lt;MeshType,3&gt; Xh;

// using the auto keyword
MeshType mesh = loadMesh( _mesh=new MeshType );
auto Xh = Pch&lt;3&gt;( mesh );
// is equivalent to
auto Xh = FunctionSpace&lt;MeshType,bases&lt;Lagrange&lt;3&gt;&gt;&gt;::New( mesh );
auto Xh = Pch_type&lt;MeshType,3&gt;::New( mesh );</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functions"><a class="anchor" href="#_functions"></a>1. Functions</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
One important feature in <code>FunctionSpace</code> is that it embeds the
definition of element which allows for the strict definition of an
<code>Element</code> of a <code>FunctionSpace</code> and thus ensures the correctness of the
code.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An element has its representation as a vector, also in the case of product of multiple spaces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">#include &lt;feel/feeldiscr/pch.hpp&gt;

// Mesh with triangles
using MeshType = Mesh&lt;Simplex&lt;2&gt;&gt;;
auto mesh = loadMesh( _mesh=new MeshType );

// define P3 Lagrange finite element space
auto P3ch = Pch&lt;3&gt;(mesh);

// definie an element from P3ch, initialized to 0
auto u = P3ch.element();
// definie an element from P3ch, initialized to x^2+y^2
auto v = P3ch.element(Px()*Px()+Py()*Py());</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_components"><a class="anchor" href="#_components"></a>1.1. Components</h3>
<div class="paragraph">
<p>Components of vectorial or matrix function spaces can be accessed and manipulated as functions.</p>
</div>
<div class="listingblock">
<div class="title">Components of a function space</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">// FunctionSpace&lt;Mesh&lt;Simplex&lt;2&gt; &gt;, bases&lt;Lagrange&lt;2,Vectorial&gt;&gt;&gt;
auto Xh = Pchv&lt;2&gt;(mesh);
auto U=Xh-&gt;element();
auto ux = u.comp(X);
auto uy = u.comp(Y);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the components of a vectorial or matrix function space are interleaved.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_product_of_function_spaces"><a class="anchor" href="#_product_of_function_spaces"></a>2. Product of function spaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Products of function spaces are supported.
This is very powerful to describe complex multiphysics problems when coupled with operators, functionals and forms described in the next sections.
Extracting subspaces or component spaces are part of the interface of product of function spaces.</p>
</div>
<div class="paragraph">
<p>There are two ways to manipulate product of function spaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>embed the product in the <code>FunctionSpace</code> class</p>
</li>
<li>
<p>define a product of function spaces which is not itself a <code>FunctionSpace</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_embed_the_product"><a class="anchor" href="#_embed_the_product"></a>2.1. Embed the product</h3>
<div class="paragraph">
<p>To embed the product into the <code>FunctionSpace</code>, we use <code>bases&lt;&gt;</code> to collect the basis function that span the component spaces.
We can pass an arbitrary number of function spaces at compile time using variadic templates.
The resulting function space is called a <strong>composite function space</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Define a composite FunctionSpace</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">using P2P1P1_t = FunctionSpace&lt;Mesh&lt;Simplex&lt;2&gt; &gt;, <i class="conum" data-value="1"></i><b>(1)</b>
 bases&lt;Lagrange&lt;2,Vectorial&gt;,    <i class="conum" data-value="2"></i><b>(2)</b>
       Lagrange&lt;1,Scalar&gt;,       <i class="conum" data-value="3"></i><b>(3)</b>
       Lagrange&lt;1,Scalar&gt;        <i class="conum" data-value="4"></i><b>(4)</b>
      &gt;
&gt;;
auto Xh = P2P1P1_t::New( mesh );</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>define the support of the composite function space and its components</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the first component space is spanned by <code>Lagrange&lt;2,Vectorial&gt;</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>the second component space is spanned by <code>Lagrange&lt;1,Scalar&gt;</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>the third component space is spanned by <code>Lagrange&lt;1,Scalar&gt;</code></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
in order to identify the function spaces in the preceding example, Feel++ adds a tag to the resulting function space to identify it uniquely as well as its functions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A composite function space has no explicit DOF table as it corresponds to the collection of the DOF tables of the component spaces shifted by the index of the component space.</p>
</div>
<div class="paragraph">
<p>The component spaces and elements of a composite function space can be accessed using respectively</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>functionSpace&lt;index&gt;()</code> method where <code>index</code> give the index of the space starting from 0</p>
</li>
<li>
<p><code>element&lt;index&gt;()</code> where <code>index</code> give the index of the space starting from 0</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example of composite space illustrating <code>functionSpace&lt;&gt;</code> and <code>element&lt;&gt;</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">using P2P1P1_t = FunctionSpace&lt;Mesh&lt;Simplex&lt;2&gt; &gt;,
 bases&lt;Lagrange&lt;2,Vectorial&gt;, Lagrange&lt;1,Scalar&gt;,
       Lagrange&lt;1,Scalar&gt; &gt; &gt; ;
auto Xh = P2P1P1_t::New( mesh );
auto Xh1 = Xh-&gt;functionSpace&lt;0&gt;();
auto Xh2 = Xh-&gt;functionSpace&lt;1&gt;();
auto Xh3 = Xh-&gt;functionSpace&lt;2&gt;();
auto U = Xh-&gt;element();
// Views: changing a view changes U and vice versa
// view on element associated to P2
auto u = U.element&lt;0&gt;();
// extract view of first component
auto ux = u.comp(X);
// view on element associated to 1st P1
auto p = U.element&lt;1&gt;();
// view on element associated to 2nd P1
auto q = U.element&lt;2&gt;();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_product_of_function_spaces_2"><a class="anchor" href="#_product_of_function_spaces_2"></a>2.2. Product of Function Spaces</h3>
<div class="paragraph">
<p>There are two types of products:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>compile time: the number of function spaces is known at compile time and the type of the function spaces can be different</p>
</li>
<li>
<p>runtime: the number of function spaces is dynamic, the type must the same but the support of the spaces may be different</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In both cases, the data structures allow to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>iterate over the underlying space</p>
</li>
<li>
<p>define elements of the product and access its components</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both forms of the product can be used by <code>blockform</code>.
It allows to define bilinear and linear over these products and manipulate the corresponding blocks either at compile time or run time.</p>
</div>
<div class="sect3">
<h4 id="_runtime_product"><a class="anchor" href="#_runtime_product"></a>2.2.1. Runtime product</h4>
<div class="paragraph">
<p>The runtime product of function spaces allows to create a dynamic product of spaces of the same type but not necessarily of the same support.
if the mesh support is the same for all components then the doftable is built only for one component, the others are obtained by shifting the first doftable.</p>
</div>
<div class="listingblock">
<div class="title">Example of dynamic product of function space</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">#include &lt;feel/feeldiscr/product.hpp &gt;
// ...
// dynamic function space
auto Wh = dynProduct&lt;decltype(Pch&lt;1&gt;( mesh ))&gt;( 10, mesh ); <i class="conum" data-value="1"></i><b>(1)</b>
auto Vh = Pch&lt;1&gt;( mesh ); <i class="conum" data-value="2"></i><b>(2)</b>
auto Xh = dynProduct( 10, Vh ); <i class="conum" data-value="3"></i><b>(3)</b>
auto U = Xh.element(); <i class="conum" data-value="4"></i><b>(4)</b>
auto u = U[0]; <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>define a product of 10 function space with support <code>mesh</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>defines a P1 piecewise continuous function space</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>defines a product of 10 function space based on <code>Vh</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>create an element of the product of function space</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>create a view on the first component of the function space</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
there is also a <code>shared_ptr&lt;&gt;</code> version, <code>dynProductPtr</code>, which returns a shared pointer product of function space.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_compile_time_product"><a class="anchor" href="#_compile_time_product"></a>2.2.2. Compile time product</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">// define mesh
auto Xh=Pch&lt;1&gt;(mesh);
auto Wh=Pchv&lt;2&gt;(mesh);
auto Zh = productPtr(Xh,Wh); <i class="conum" data-value="1"></i><b>(1)</b>
auto U = Zh-&gt;element(); <i class="conum" data-value="2"></i><b>(2)</b>
auto cXh = Zh-&gt;functionSpace(0_c);
auto cWh = Zh-&gt;functionSpace(1_c);
auto ex = exporter(_mesh=mesh);
ex-&gt;add("u",U(0_c)); <i class="conum" data-value="3"></i><b>(3)</b>
ex-&gt;add("v",U(1_c)); <i class="conum" data-value="4"></i><b>(4)</b>
ex-&gt;save();</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>create the compile time product <code>Zh</code> of <code>Xh</code> and <code>Wh</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>create an element of <code>Zh</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>export the first component, element of</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_mixing_runtime_and_compile_time_product"><a class="anchor" href="#_mixing_runtime_and_compile_time_product"></a>2.2.3. Mixing Runtime and Compile time product</h4>
<div class="paragraph">
<p>It is possible to mix compile time and one runtime product of function spaces provided that the dynamic function space is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">auto Xh = Pch&lt;1&gt;(mesh);
auto Zh = Pch&lt;1&gt;(mesh);
auto Yh = Pchv&lt;3&gt;(mesh);
auto Vh = dynProductPtr&lt;decltype(Pch&lt;2&gt;(mesh))&gt;( n, mesh );
auto p = product2( Xh, Yh, Zh, Vh );

cout &lt;&lt; "number of spaces " &lt;&lt; p.numberOfSpaces() &lt;&lt; std::endl;
auto U = p.element();
auto u = U(0_c); <i class="conum" data-value="1"></i><b>(1)</b>
auto y = U(1_c); <i class="conum" data-value="2"></i><b>(2)</b>
auto z = U(2_c); <i class="conum" data-value="3"></i><b>(3)</b>
for( int i = 0; i &lt; Vh-&gt;numberOfSpaces(); ++i )
  auto v = U( 3_c, i ); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>view on component 0, element of Xh</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>view on component 1, element of Yh</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>view on component 2, element of Zh</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>view on component 3, i-th element of Vh</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer" style="border-top: 2px solid #e9e9e9; background-color: #fafafa; padding-bottom: 2em; padding-top: 2em;">
    <div class="container" style="display: flex; flex-direction: column; align-items: center; gap: 0.5em;">
        <div>
            <a href="https://www.cemosis.fr">
                <img src="../../../../_/img/cemosis-logo.svg" alt="Cemosis logo" height="50">
            </a>
        </div>
        <span style="font-size: 0.8rem; color: #9e9e9e">© 2023 <a href="https://www.cemosis.fr" style="text-decoration: underline;">Cemosis</a>, Université de Strasbourg</span>
    </div>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>


<script async src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>


<script type="text/javascript">
function toggleFullScreen() {
   var doc = window.document;
   var docEl = doc.documentElement;

   var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
   var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

   if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
       requestFullScreen.call(docEl);
   }
   else {
       cancelFullScreen.call(doc);
   }
}
</script>
  </body>
</html>
